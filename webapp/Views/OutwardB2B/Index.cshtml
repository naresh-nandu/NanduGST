@using System.Dynamic
@model List<System.Collections.IDictionary>
@{
				/**/

				/**/

				WebGrid grid = null;
				int rowVal = 0;
				var result = new List<dynamic>();
				if (@Model != null)
				{
					foreach (var emprow in Model)
					{
						var row = (IDictionary<string, object>)new ExpandoObject();
						Dictionary<string, object> eachEmpRow = (Dictionary<string, object>)emprow;

						foreach (KeyValuePair<string, object> keyValuePair in eachEmpRow)
						{
							row.Add(keyValuePair);
						}
						result.Add(row);
					}
					grid = new WebGrid(result);
				}
}


<style type="text/css">
	.ui-autocomplete {
		max-height: 200px;
		width: 800px;
		overflow-y: auto;
		/* prevent horizontal scrollbar */
		overflow-x: auto;
		/* add padding to account for vertical scrollbar */
		padding-right: 20px;
		background-color: palegoldenrod
	}

	table.gridtable th {
		text-align: center;
		font-weight: bold;
		font-size: 14px;
		color: #3276b1;
	}

	table.gridtable td {
		text-align: center;
	}

	.parent .popup {
		display: none;
	}

	.parent:hover .popup {
		display: block;
	}
</style>


<div id="content">

	<div class="row">

		<div class="col-xs-12 col-sm-7 col-md-7 col-lg-4">
			<h1 class="page-title txt-color-blueDark">

				<i class="fa-fw fa fa-home"></i>
				Outward Register
				<span>
					>&nbsp;
					B2B
				</span>
			</h1>
		</div>


	</div>

	<form action="@Url.Action("Index", "OutwardB2B")" method="post" id="OutwardB2B" novalidate="novalidate">

		<section id="widget-grid" class="">

			<!-- row -->
			<div class="row">

				<!-- NEW WIDGET START -->
				<article class="col-xs-12 col-sm-12 col-md-12 col-lg-12">

					<!-- Widget ID (each widget will need unique ID)-->
					<div class="jarviswidget jarviswidget-color-teal" id="wid-id-0" data-widget-editbutton="false" data-widget-custombutton="false" data-widget-deletebutton="false">

						<header>
							<span class="widget-icon"><i class="fa fa-edit"></i></span>
							<h2 style="font-weight:bold;">Outward B2B</h2>
						</header>

						<!-- widget div-->
						<div>

							<!-- widget edit box -->
							<div class="jarviswidget-editbox">
								<!-- This area used as dropdown edit box -->

							</div>
							<!-- end widget edit box -->
							<!-- widget content -->
							<div class="widget-body no-padding">

								<div id="comment-form" class="smart-form">
									<fieldset class="smart-form">
										<div class="row">
											<section class="col col-3">
												<div class="form-group">
													<label>Customer Name<span style="color:red">*</span></label>
													<div>
														@Html.DropDownList("name", new SelectList(ViewBag.buyname, "buyerid", "buyername", @Session["nameob2b"]), "--Select--", new { @Class = "form-control input-sm", @id = "name", @onblur = "taxableCalculation();" })
													</div>
												</div>
											</section>

											<section class="col col-3">
												<label>Customer GSTIN</label>@*<span style="color:red">*</span>*@
												<label class="input">
													<i class="icon-prepend fa fa-user"></i>
													<input type="text" name="gstin" id="gstin" value="@Session["gstinob2b"]" placeholder="Customer GSTIN" readonly style="background-color:#d9d9d9;">
												</label>
											</section>


											@if (Session["MasterdtlsOB2B"] != null)
											{
												<section class="col col-3">
													<label>Place of Supply</label>
													<label class="input">
														<input type="text" name="pos" id="pos" value="@Session["posob2b"]" placeholder="State Code" readonly style="background-color:#d9d9d9;">
													</label>
												</section>
											}
											else
											{
												<section class="col col-3">
													<label>Place of Supply</label>
													<label class="input">
														<input type="text" name="pos" id="pos" value="@Session["posob2b"]" placeholder="State Code">
													</label>
												</section>
											}
											<section class="col col-3">
												<label>Address</label>
												<label class="input">
													<input type="text" name="address" id="address" value="@Session["addressob2b"]" placeholder="Address" readonly style="background-color:#d9d9d9;">
												</label>
											</section>

										</div>
										<div class="row">
											<section class="col col-3">
												<div class="form-group">
													<label>Taxpayer GSTIN<span style="color:red">*</span></label>
													<div>
														@Html.DropDownList("cgstin", new SelectList(ViewBag.Categories, "GSTINNo", "GSTINNo", @Session["cgstinob2b"]), "--Select--", new { @Class = "form-control input-sm", @id = "cgstin", @onchange = "taxableCalculation();" })
													</div>
												</div>
											</section>
											<section class="col col-3">
												<div class="form-group">
													<label>Auto Invoice Number Generation<span style="color:red">*</span></label>
													<div>
														@if (Session["AutoGenInvNoSetting"].ToString() == "False")
														{
															if (Session["isautoob2b"] == null)
															{
																<input type="radio" name="isauto" value="Yes" class="name" /><label>Yes&nbsp;&nbsp;&nbsp;</label>
																<input type="radio" name="isauto" value="No" class="name" checked><label>No&nbsp;&nbsp;&nbsp;</label>
															}
															else if (Session["isautoob2b"].ToString() == "No")
															{
																<input type="radio" name="isauto" value="Yes" class="name" /><label>Yes&nbsp;&nbsp;&nbsp;</label>
																<input type="radio" name="isauto" value="No" class="name" checked><label>No&nbsp;&nbsp;&nbsp;</label>
															}
															else if (Session["isautoob2b"].ToString() == "Yes")
															{
																<input type="radio" name="isauto" value="Yes" class="name" checked /><label>Yes&nbsp;&nbsp;&nbsp;</label>
																<input type="radio" name="isauto" value="No" class="name"><label>No&nbsp;&nbsp;&nbsp;</label>
															}
														}
														@if (Session["AutoGenInvNoSetting"].ToString() == "True")
														{
															<input type="radio" name="isauto" value="Yes" class="name" checked readonly /><label>Yes&nbsp;&nbsp;&nbsp;</label>
														}
													</div>
												</div>
											</section>
											<section class="col col-3">
												<label> Invoice Number</label>@*<span style="color:red">*</span>*@
												<label class="input">
													@if (Session["isautoob2b"] == null || Session["isautoob2b"].ToString() == "Yes")
													{
														<input type="text" name="invoice" id="invoice" maxlength="16" class="invoice" value="@Session["invoiceob2b"]" placeholder="Invoice No.">
													}
													else
													{
														<input type="text" name="invoice" id="invoice" maxlength="16" class="invoice" value="@Session["invoiceob2b"]" placeholder="Invoice No.">
													}
												</label>
											</section>

											<section class="col col-3">
												<label>Invoice Date</label><span style="color:red">*</span>
												<label class="input">
													<i class="icon-append fa fa-calendar"></i>
													<input type="text" name="invoicedate" id="invoicedate" value="@Session["invoicedateob2b"]" placeholder="Invoice Date" class="datepicker" data-dateformat='dd-mm-yy' readonly>
												</label>
											</section>


										</div>
										<div class="row">
											<section class="col col-3">
												<label>Invoice Value</label>
												<label class="input">
													<input type="text" name="invalue" id="invalue" value="@Session["invalueob2b"]" placeholder="Invoice Value" readonly style="background-color:#d9d9d9;" class="floatinput">
												</label>
											</section>
											<section class="col col-3">
												<label>Ecommerce Operator</label>
												<label class="input">
													<input type="text" name="etin" id="etin" value="@Session["etinob2b"]" placeholder="Etin" onblur="Etin()" maxlength="15" style="text-transform:uppercase">
												</label>
											</section>
											<section class="col col-3">
												<div class="form-group">
													<label>Reverse Charge<span style="color:red">*</span></label>
													<div>
														@Html.DropDownList("reversecharge", new SelectList(new List<SelectListItem> { new SelectListItem { Text = "Yes", Value = "Y" }, new SelectListItem { Text = "No", Value = "N" } }, "Value", "Text", @Session["reversechargeob2b"]), "--Select--", new { @Class = "form-control input-sm" })
													</div>
												</div>
											</section>
											<section class="col col-3">
												<div class="form-group">
													<label>Invoice type<span style="color:red">*</span></label>
													<div>
														@Html.DropDownList("invtype", new SelectList(new List<SelectListItem> { new SelectListItem { Text = "Regular B2B Invoices", Value = "R" },
																																new SelectListItem { Text = "Deemed Exports", Value = "DE" },
																																new SelectListItem { Text = "SEZ Exports with payment", Value = "SEWP" },
																																new SelectListItem { Text = " SEZ exports without payment", Value = "SEWOP" } }, "Value", "Text", @Session["invtypeob2b"]), "--Select--", new { @Class = "form-control input-sm" })
													</div>
												</div>
											</section>

										</div>
										<div class="row">
											<section class="col col-3">

												<label>Is Discount Applicable</label>

												@if (Session["MasterdtlsOB2B"] != null)
												{
													if (((System.Data.DataTable)Session["MasterdtlsOB2B"]).Rows.Count >= 1)
													{<label class="input">
															@Html.DropDownList("isDiscountreq", new SelectList(new List<SelectListItem> { new SelectListItem { Text = "No", Value = "No" },
																															new SelectListItem { Text = "Yes", Value = "Yes" } }, "Value", "Text", @Session["discountreqob2b"]), new { @Class = "form-control input-sm", @id = "isDiscountreq", @disabled = "true" })

														</label>}
												}
												else
												{<label class="input">
														@Html.DropDownList("isDiscountreq", new SelectList(new List<SelectListItem> { new SelectListItem { Text = "No", Value = "No" },
																															new SelectListItem { Text = "Yes", Value = "Yes" } }, "Value", "Text", @Session["discountreqob2b"]), new { @Class = "form-control input-sm", @id = "isDiscountreq" })

													</label>}

											</section>

											@if (Session["InvFormat"].ToString() == "1")
											{
												<section section class="col col-3">
													<div class="form-group">
														<label>Service Type</label>
														<div>
															@Html.DropDownList("ddlServiceType", ViewBag.ServiceTypeList as SelectList, "Select", new { @Class = "form-control input-sm", @id = "ddlServiceType" })
														</div>
													</div>
												</section>
												<section section class="col col-3">
													<div class="form-group">
														<label>Transport Mode</label>
														<div>
															@Html.DropDownList("transMode", ViewBag.TransportMode as SelectList, "Select", new { @Class = "form-control input-sm", @id = "transMode" })
														</div>
													</div>
												</section>
												<section class="col col-3">
													<label>
														Vechicle No
														<span style="color:red">
															<a href="#" id="VechDiv" style="padding:10px; font-weight:bold">?</a>
														</span>
													</label>
													<label class="input">
														<input type="text" name="vehicleNo" id="vehicleNo" onchange="VehicleNoValidate()" value="@Session["vehicleNob2b"]" maxlength="15" placeholder="Vechicle No" style="text-transform:uppercase">
													</label>
													<div id="vechDiv_info" style="background-color: #F7E7D3; width: 250px; height: 200px; right: 250px; position: absolute; z-index: 9999">
														<table class="">
															<tr>
																<th>Format of Vehicle No.</th>
															</tr>
															<tr>
																<td>AB121234</td>
																<td>(or)</td>
															</tr>
															<tr>
																<td>AB12A1234</td>
																<td>(or)</td>
															</tr>
															<tr>
																<td>AB12AB1234</td>
																<td>(or)</td>
															</tr>
															<tr>
																<td>ABC1234</td>
																<td>(or)</td>
															</tr>
															<tr>
																<td>AB123A1234</td>
																<td>(or) </td>
															</tr>
															<tr>
																<td>AB12ABC1234</td>
																<td>(or) </td>
															</tr>
															<tr>
																<td>DFXXXXXX&nbsp; (for Defence Vehicle)&nbsp; </td>
																<td>&nbsp;&nbsp;(or) </td>
															</tr>
															<tr>
																<td>TRXXXXXX&nbsp; (for Temporary RC)&nbsp;</td>
																<td>&nbsp;&nbsp;(or)</td>
															</tr>
															<tr>
																<td>BPXXXXXX&nbsp; (for Bhutan)&nbsp;</td>
																<td>&nbsp;&nbsp;(or)</td>
															</tr>
															<tr>
																<td>NPXXXXXX&nbsp; (for Nepal)&nbsp;</td>
																<td></td>
															</tr>

														</table>
													</div>
												</section>

												<section class="col col-3">
													<label id="datelabel">Date Of Supply</label>
													<label class="input">
														<i class="icon-append fa fa-calendar"></i>
														<input type="text" name="dateOfSupply" autocomplete="off" id="dateOfSupply" value="@Session["dateOfSupplyb2b"]" placeholder="Date" class="datepicker" data-dateformat='dd/mm/yy' readonly>
													</label>
												</section>
												<section class="col col-3">
													<label>CIN No</label>
													<label class="input">
														<input type="text" name="cinNo" id="cinNo" value="@Session["cinNob2b"]" placeholder="CIN Number" maxlength="50">
													</label>
												</section>

											}
											<section class="col col-3">
												<label>Shipping Address</label>
												<label class="input">
													<textarea name="saddress" id="saddress" cols="31" rows="4" maxlength="250" onkeyup="limitTextarea(this,4,100)" value="@Session["saddressob2b"]">@Session["saddressob2b"]</textarea>
												</label>
											</section>

											<section class="col col-3">

												@if (Session["MakerCheckerApproverSetting"].ToString() == "True")
												{
													<label>Office Address</label>
												}
												else
												{
													<label>Additional Information</label>
												}

												<label class="input">
													<textarea name="comment1" cols="31" rows="4" value="@Session["comment1ob2b"]">@Session["comment1ob2b"]</textarea>
												</label>
											</section>

										</div>

									</fieldset>
									<div class="message">
										<i class="fa fa-check fa-lg"></i>
										<p>
											Your comment was successfully added!
										</p>
									</div>
								</div>

							</div>
							<!-- end widget content -->
						</div>
						<!-- end widget div -->
					</div>

				</article>
				<!-- end widget -->
				<!-- Widget ID (each widget will need unique ID)-->
				<article class="col-xs-12 col-sm-12 col-md-12 col-lg-12">


					<div class="jarviswidget jarviswidget-color-blueLight" id="wid-id-1" data-widget-editbutton="false" data-widget-custombutton="false" data-widget-deletebutton="false">

						<header>
							<span class="widget-icon"> <i class="fa fa-edit"></i> </span>
							<h2 style="font-weight:bold;">Item Details</h2>
						</header>

						<!-- widget div-->
						<div>

							<!-- widget edit box -->
							<div class="jarviswidget-editbox">
								<!-- This area used as dropdown edit box -->

							</div>
							<!-- end widget edit box -->
							<!-- widget content -->
							<div class="widget-body no-padding">

								<div id="comment-form1" class="smart-form">


									@{Html.RenderPartial("_Transaction"); }


								</div>

							</div>
							<!-- end widget content -->

						</div>
						<!-- end widget div -->

					</div>

				</article>

				<article class="col-xs-12 col-sm-12 col-md-12 col-lg-12">

					@if (Session["MasterdtlsOB2B"] != null)
					{
						if (((System.Data.DataTable)Session["MasterdtlsOB2B"]).Rows.Count >= 1)
						{
							<div class="jarviswidget jarviswidget-color-pink" id="wid-id-1" data-widget-editbutton="false" data-widget-custombutton="false" data-widget-deletebutton="false">

								<header>
									<span class="widget-icon"> <i class="fa fa-edit"></i> </span>
									<h2 style="font-weight:bold;">Outward B2B Item List</h2>
								</header>

								<!-- widget div-->
								<div>

									<!-- widget edit box -->
									<div class="jarviswidget-editbox">
										<!-- This area used as dropdown edit box -->

									</div>
									<!-- end widget edit box -->
									<!-- widget content -->
									<div class="widget-body no-padding">

										<div id="comment-form1" class="smart-form">

											<br />
											<div class="table-responsive">
												@grid.GetHtml(tableStyle: "table table-striped table-bordered table-hover gridtable", columns: grid.Columns(
				 grid.Column(header: "S.No", format: item => rowVal = rowVal + 1),
				 grid.Column("HSN", "HSN"),
				 grid.Column("ItemDesc", "Item Description"),
				 grid.Column("Quantity", "Qty"),
				 grid.Column("UQC", "UQC"),
				 grid.Column("Unit Price", "Unit Price"),
				 grid.Column("Discount", "Discount"),
				 grid.Column("Taxablevalue", "Taxable Value"),
				 grid.Column("Rate", "Rate"),
				 grid.Column("IGST Amount", "IGST Amount"),
				 grid.Column("CGST Amount", "CGST Amount"),
				 grid.Column("SGST Amount", "SGST Amount "),
				 grid.Column("CESS Amount", "CESS Amount"),
				 grid.Column(format:@<text>@Html.ActionLink("Delete", "Delete", new { Id = item.Srno }, new { @Class = "btn btn-sm btn-danger", @style = "font-weight:bold;Border-radius:10px;width:60px;margin-bottom:3px;padding:3px" }) </text>, header: "Action")
)
)
											</div>

											<footer>
												<div class="row">
													@if (Session["Setting"].ToString() == "False")
													{
														<div class="col-md-6 text-center">
															<button type="submit" name="command" value="save1" style="font-weight:bold;Border-radius:10px;width:80px;text-align:center;" class="btn btn-primary">Save</button>
														</div>
													}
													else if (Session["Setting"].ToString() == "True")
													{
														<div class="col-md-6 text-center">
															<button type="submit" name="command" value="save2" style="font-weight:bold;Border-radius:10px;width:180px;text-align:center;" class="btn btn-primary">Genarate Invoice</button>
														</div>
													}


												</div>
											</footer>


										</div>

									</div>
									<!-- end widget content -->

								</div>
								<!-- end widget div -->

							</div>
						}
					}
				</article>





				<!-- end widget -->
			</div>

			<!-- end row -->
			<!-- row -->
			<!-- end row -->
		</section>
		<div id="popup_pdf">

		</div>
	</form>
</div>

@if (Session["AutoGenInvNoSetting"].ToString() == "True")
{
	<script type="text/javascript">
		$(document).ready(function () {
			var today = new Date();
			var date = parseInt(today.getDate());
			if (date <= 6) {
				$("#invoicedate").datepicker({
					minDate: '01-' + today.getMonth() + '-' + today.getFullYear(),
					maxDate: today.getDate() + '-' + (parseInt(today.getMonth()) + 1) + '-' + today.getFullYear(),
					dateFormat: 'dd-mm-yy',
					prevText: '<i class="fa fa-chevron-left"></i>',
					nextText: '<i class="fa fa-chevron-right"></i>'
				});
			}
			else {
				$("#invoicedate").datepicker({
					minDate: '01-' + (parseInt(today.getMonth()) + 1) + '-' + today.getFullYear(),
					maxDate: today.getDate() + '-' + (parseInt(today.getMonth()) + 1) + '-' + today.getFullYear(),
					dateFormat: 'dd-mm-yy',
					prevText: '<i class="fa fa-chevron-left"></i>',
					nextText: '<i class="fa fa-chevron-right"></i>'
				});
			}

		});
	</script>
}



@if (TempData["Message"] != null)
{
	<script type="text/javascript">
        alert(@Html.Raw(Json.Encode(TempData["Message"])));
        @*var invnum=@Session["invnum"];
        var invdate=@Session["invdate"];
        var url="InvId="+invnum+"&&InvDate="+invdate;

        var ph = $("#popup_pdf").html(;*@

        //ph.load("DownloadPDF/Demo", function () {
        //    ph.dialog({
        //        modal: true,
        //        width: 1000,
        //        height: 400,
        //        title: "Edit Invoice Items",
        //        resizable: true
        //    });
        //});
	</script>
	TempData["Message"] = null;
}
<script type="text/javascript">
	$(document).ready(function () {
		$('.invoice').on("keyup", function (e) {

			return validateFloatKeyPress(this, e);
		});
	});

	function validateFloatKeyPress(el, evt) {

		var regex = /^[0-9A-Z/-]*$/i;
		// var str = String.fromCharCode(!e.charCode ? e.which : e.charCode);
		if ($('#invoice').val() != "") {
			if (!$('#invoice').val().match(regex)) {
				alert("No special characters allowed except '-' and '/'.");
				$('#invoice').val('');
				//  return false;
			}
		}
	}

</script>


@section pagespecific{
	<script type="text/javascript">

		function limitTextarea(textarea, maxLines, maxChar) {
			var lines = textarea.value.replace(/\r/g, '').split('\n'), lines_removed, char_removed, i;
			if (maxLines && lines.length > maxLines) {
				lines = lines.slice(0, maxLines);
				lines_removed = 1
			}
			if (maxChar) {
				i = lines.length;
				while (i-- > 0) if (lines[i].length > maxChar) {
					lines[i] = lines[i].slice(0, maxChar);
					char_removed = 1
				}
				if (char_removed || lines_removed) {
					textarea.value = lines.join('\n')
				}
			}
		}

		function taxableCalculation() {
			//Address = document.getElementById("address");
			//SAdd = document.getElementById("saddress");
			//SAdd.value = Address.value;
			var qty = document.getElementById("qty").value;
			var unitprice = document.getElementById("unitprice").value;
			var discount = document.getElementById("discount").value;
			var rate = document.getElementById("rate").value;


			var igsta = document.getElementById("iamount");
			var cgsta = document.getElementById("camount");
			var sgsta = document.getElementById("samount");

			if ((qty != "") && (unitprice != "") && (discount != "")) {

				var discountValue;
				discountValue = (((qty * unitprice) / 100) * discount);
				document.getElementById("taxablevalue").value = ((unitprice * qty) - discountValue).toFixed(2);
			}
			var taxablevalue = document.getElementById("taxablevalue").value;
			//var textLength = taxablevalue.value.length;
			//if (textLength > 14) {
			//    alert("Value should be less than mjlkdj");
			//}

			if ((taxablevalue != "") && (rate != "")) {
				var cgstin = document.getElementById("cgstin").value;
				var gstin = document.getElementById("pos").value;
				var cgstin_state = cgstin.substring(0, 2);
				var gstin_state = gstin.substring(0, 2);
				if ((gstin_state != "") && (cgstin_state != "")) {
					if (gstin_state != cgstin_state) {
						igsta.value = (taxablevalue * rate) / 100;
						cgsta.value = "0";
						sgsta.value = "0";
					}
					else if (gstin_state == cgstin_state) {
						igsta.value = "0";
						cgsta.value = (taxablevalue * (rate / 2)) / 100;
						sgsta.value = (taxablevalue * (rate / 2)) / 100;
					}
				}
			}
		}
	</script>
	@*<script type="text/javascript" >
		//function check() {

		//    var etin = document.getElementById("etin").value;
		//    if (etin != "") {
		//        var pat = /^[0-9]{2}[a-zA-Z]{5}[0-9]{4}[a-zA-Z]{1}[1-9a-zA-Z]{1}[zZ][0-9a-zA-Z]{1}$/;
		//        var res = pat.test(etin);
		//        if (!res) {
		//            alert("Wrong etin format");
		//            return false;
		//        }
		//    }

		//}

		</script>*@

	<script type="text/javascript">
		function invnumVal() {
			var invoiceval = document.getElementById("invoice").value;
			if (invoiceval == null) {
				alert("Please enter Invoice Number");
				return false;
			}
		}

	</script>

	@if (Session["MakerCheckerApproverSetting"].ToString() == "True")
	{
		<script type="text/javascript">
			$("#hsn").on('blur', function () {
				var txt = $('#hsn').val().split("|");
				$('#hsn').val(txt[0]);
				$("#rate").val(txt[1]);
				var result = txt[2];
				$("#itemdesc").val(result.slice(0, 30));
			});

			$(document).ready(function () {
				$("#hsn").autocomplete({
					minlength: 3,
					scroll: true,
					source: function (request, response) {
						$.ajax({
							url: "/OutwardB2B/AutoPopulate",
							type: "POST",
							dataType: "json",
							data: { Prefix: request.term },
							success: function (data) {
								response($.map(data, function (item) {
									return {
										label: item.hsncode + "-" + item.rate,
										value: item.hsncode + "|" + item.rate + "|" + item.hsndesc
									};
								}));
							},
							messages: {
								noResults: "", results: "",
							}
						});
					}
				});
			})
		</script>
		/**/

	}
	else
	{
		<script type="text/javascript">
			$("#hsn").on('blur', function () {
				var txt = $('#hsn').val().split("|");
				$('#hsn').val(txt[0]);
				$("#rate").val(txt[1]);
			});

			$(document).ready(function () {
				$("#hsn").autocomplete({
					minlength: 3,
					scroll: true,
					source: function (request, response) {
						$.ajax({
							url: "/OutwardB2B/AutoPopulate",
							type: "POST",
							dataType: "json",
							data: { Prefix: request.term },
							success: function (data) {
								response($.map(data, function (item) {
									return {
										label: item.hsncode + "-" + item.hsndesc,
										value: item.hsncode + "|" + item.rate
									};
								}));
							},
							messages: {
								noResults: "", results: "",
							}
						});
					}
				});
			})
		</script>
	}

	<script type="text/javascript">


		function VehicleNoValidate() {
			Number = document.getElementById("vehicleNo").value;
			Number = Number.toUpperCase();
			if (Number != "") {
				var pattern1 = /^[A-Z|a-z]{2}[0-9]{2}[A-Z|a-z]{2}[0-9]{4}$/;
				var pattern2 = /^[A-Z|a-z]{2}[0-9]{2}[A-Z|a-z]{1}[0-9]{4}$/;
				var pattern3 = /^[A-Z|a-z]{2}[0-9]{6}$/;
				var pattern4 = /^[A-Z a-z]{2}[0-9]{2}[A-Z a-z]{0,2}[0-9]{4}$/;
				var pattern5 = /^[A-Z a-z]{3}[0-9]{4}$/;
				var pattern6 = /^[A-Z a-z]{2}[0-9]{3}[A-Z a-z]{1}[0-9]{4}$/;
				var pattern7 = /^[A-Z a-z]{2}[0-9]{2}[A-Z a-z]{3}[0-9]{4}$/;

				if (Number.length >= 5) {
					var res1 = pattern1.test(Number);
					var res2 = pattern2.test(Number);
					var res3 = pattern3.test(Number);
					var res4 = pattern4.test(Number);
					var res5 = pattern5.test(Number);
					var res6 = pattern6.test(Number);
					var res7 = pattern7.test(Number);
					if (Number.substring(0, 2).toUpperCase() != "DF" && Number.substring(0, 2).toUpperCase() != "TR" && Number.substring(0, 2).toUpperCase() != "BP" && Number.substring(0, 2).toUpperCase() != "NP") {
						if (res1 || res2 || res3 || res4 || res5 || res6 || res7) {

						}
						else {
							$("#vehicleNo").val('');
							alert("Please enter a valid Vehicle No.");
							document.getElementById("vehicleNo").focus();
						}
					}
					else {
						if (Number.length > 8) {
							$("#vehicleNo").val('');
							alert("Please enter a valid Vehicle No.");
							document.getElementById("vehicleNo").focus();
						}
					}
				}
				else {
					$("#vehicleNo").val('');
					alert("Please enter a valid Vehicle No.");
					document.getElementById("vehicleNo").focus();
				}
			}
		}

		$(document).ready(function () {

			var invType = @Session["InvFormat"].ToString();

			if (invType == 1) {
				$('#vechDiv_info').hide();

				//Diplay div on mouseover
				$('#VechDiv').mouseover(function () {
					$('#vechDiv_info').show("slow");
				});

				//Hide div on mouseover
				$('#VechDiv').mouseout(function () {
					//Check if mouse is over second div
					if ($('#vechDiv_info').is(':hover')) {
						//If so then show the second div
						$('#vechDiv_info').show("slow");
					} else {
						$('#vechDiv_info').hide("slow");
					}
				});

				//Hide div on mouseover from second div
				$('#vechDiv_info').mouseout(function () {
					$('#vechDiv_info').hide("slow");
				});


				if (document.getElementById('transMode').value == "1") {
					$('#vehicleNo').removeAttr("readonly").css("background-color", "white");
				}
				else if (document.getElementById('transMode').value == "2") {
					$('#vehicleNo').val("").attr("readonly", "true").css("background-color", "#d9d9d9");
				}
				else if (document.getElementById('transMode').value == "3") {
					$('#vehicleNo').val("").attr("readonly", "true").css("background-color", "#d9d9d9");
				}
				else if (document.getElementById('transMode').value == "4") {
					$('#vehicleNo').val("").attr("readonly", "true").css("background-color", "#d9d9d9");
				}


				$('#transMode').on('change', function () {
					debugger;
					if (document.getElementById('transMode').value == "1") {
						$('#vehicleNo').removeAttr("readonly").css("background-color", "white");
					}
					else if (document.getElementById('transMode').value == "2") {
						$('#vehicleNo').val("").attr("readonly", "true").css("background-color", "#d9d9d9");
					}
					else if (document.getElementById('transMode').value == "3") {
						$('#vehicleNo').val("").attr("readonly", "true").css("background-color", "#d9d9d9");
					}
					else if (document.getElementById('transMode').value == "4") {
						$('#vehicleNo').val("").attr("readonly", "true").css("background-color", "#d9d9d9");
					}
				})


			}

			var ischeck = $("input[type=radio][name='isauto']:checked").val();


			if (ischeck == "No" || ischeck == "") {
				$('#invoice').removeAttr("readonly").css("background-color", "white");

			}
			else {
				$('#invoice').val("-").attr("readonly", "true").css("background-color", "#d9d9d9");
			}

			$(":radio").on('click', function () {
				var ischeck = $(this).val();
				if (ischeck == "No") {
					$('#invoice').removeAttr("readonly").css("background-color", "white");

				}
				else {
					$('#invoice').val("-").attr("readonly", "true").css("background-color", "#d9d9d9");
				}
			});
			var discresq = $('#isDiscountreq').val();
			if (discresq != "No") {
				$('#discount').removeAttr("readonly").css("background-color", "white");
			}
			else {
				$('#discount').val("0").attr("readonly", "true").css("background-color", "#d9d9d9");
			}
			$("#isDiscountreq").on('change', function () {
				var discresq = $('#isDiscountreq').val();
				if (discresq != "No") {
					$('#discount').removeAttr("readonly").css("background-color", "white");
				}
				else {
					$('#discount').val("0").attr("readonly", "true").css("background-color", "#d9d9d9");
				}
			});


			$("#name").on('change', function () {
				var name = $(this).val();
				$.ajax({
					type: "GET",
					url: '/OutwardB2B/load',
					data: { name: name },
					contentType: "application/json;charset=utf-8",
					dataType: "json",
					success: function (data) {
						$("#pos").val(data.StateCode);
						$("#address").val(data.Address);
						$("#saddress").val(data.Address);
						$("#gstin").val(data.GSTINno);
					}

				});
			});



			$('#btnSubmit').click(function () {

				var $regexname = /^[0-9]{2}[a-zA-Z]{5}[0-9]{4}[a-zA-Z]{1}[1-9a-zA-Z]{1}[zZ][0-9a-zA-Z]{1}$/;

				if ($('#etin').val() != "") {
					if (!$('#etin').val().match($regexname)) {
						alert("Wrong Etin");
						return false;
					}
				}



				var $checkoutForm = $('#OutwardB2B').validate({
					// Rules for form validation
					rules: {
						uqc: {
							required: true

						},
						cgstin: {
							required: true

						},
						name: {
							required: true

						},
						isauto: {
							required: true

						},
						invtype: {
							required: true

						},
						invoicedate: {
							required: true

						},

						reversecharge: {
							required: true

						},
						invoice: {
							required: true


						},
						HSN: {
							required: true


						},
						itemdesc: {
							required: true


						},
						taxablevalue: {
							required: true,
							maxlength: 14,
							number: true


						},
						rate: {
							required: true,
							number: true


						},
						iamount: {
							required: true,
							number: true


						},
						camount: {
							required: true,
							number: true


						},
						samount: {
							required: true,
							number: true


						},
						csamount: {
							//required: true,
							number: true


						},
						unitprice:
						{
							required: true,
							number: true,
							min: 0.01

						},
						discount:
						{
							required: true,
							number: true,
							min: 0,
							max: 99

						}
						,
						qty:
						{
							required: true,
							number: true,
							min: 0.01

						}

					},

					// Messages for form validation
					messages: {
						uqc: {
							required: 'Please select UQC'

						},
						cgstin: {
							required: 'Please select Taxpayer GSTIN'

						},
						name: {
							required: 'Please select Customer Name'

						},
						isauto: {
							required: 'Please select Invoice Auto Generation'

						},
						invoicedate: {
							required: 'Please select Invoice Date'


						},

						invoice: {
							required: 'Please enter invoice value'


						},
						reversecharge: {
							required: 'Please select Reverse Charge'


						},
						HSN: {
							required: 'Please select HSN'


						},
						itemdesc: {
							required: 'Please enter Item Description'


						},
						rate: {
							required: 'Please select HSN Code from list',
							number: 'Characters are not allowed'


						},
						taxablevalue: {

							required: 'Please enter Taxable Value',
							required: 'Value should not be more than 14 characters',
							number: 'Characters are not allowed'


						},
						iamount: {
							required: 'Please enter IGST Amount',
							number: 'Characters are not allowed'


						},
						camount: {
							required: 'Please enter CGST Amount',
							number: 'Characters are not allowed'


						},
						samount: {
							required: 'Please enter SGST/UTGST Amount',
							number: 'Characters are not allowed'


						},
						csamount: {
							//required: 'Please enter CESS Amount',
							number: 'Characters are not allowed'


						},
						unitprice: {
							required: 'Please enter Unit Price',
							number: 'Characters are not allowed'


						},

						discount: {
							required: 'Please enter Discount',
							number: 'Characters are not allowed'


						},
						qty: {
							required: 'Please enter Qty',
							number: 'Characters are not allowed'


						},
						invtype: {
							required: 'Please select Invoice Type'


						}


					},

					// Do not change code below
					errorPlacement: function (error, element) {
						error.insertAfter(element.parent());
					}
				})



			});
		})
		jQuery.extend(jQuery.validator.messages, {

			maxlength: jQuery.validator.format("Value can not be more than 99990000000.00 Crores."),

		});

	</script>



}
