@using System.Dynamic
@model List<System.Collections.IDictionary>
@{
    WebGrid grid = null;
    var result = new List<dynamic>();
    if (ViewBag.Summary != null)
    {
        //TempData["Data"] = Model;
        foreach (var emprow in ViewBag.Summary)
        {
            var row = (IDictionary<string, object>)new ExpandoObject();
            Dictionary<string, object> eachEmpRow = (Dictionary<string, object>)emprow;

            foreach (KeyValuePair<string, object> keyValuePair in eachEmpRow)
            {
                row.Add(keyValuePair);
            }
            result.Add(row);
        }
        grid = new WebGrid(source: result, canPage: true, canSort: true);
    }
}

@{
    WebGrid grid1 = null;
    var result1 = new List<dynamic>();
    if (ViewBag.ITCLedger != null)
    {
        //TempData["Data"] = Model;
        foreach (var emprow in ViewBag.ITCLedger)
        {
            var row1 = (IDictionary<string, object>)new ExpandoObject();
            Dictionary<string, object> eachEmpRow = (Dictionary<string, object>)emprow;

            foreach (KeyValuePair<string, object> keyValuePair in eachEmpRow)
            {
                row1.Add(keyValuePair);
            }
            result1.Add(row1);
        }
        grid1 = new WebGrid(source: result1, canPage: true, canSort: true);
    }
}


<script type="text/javascript">

    $(document).ready(function () {

        oTableStaticFlow = $('#example').DataTable({
            "aoColumnDefs": [{
                'bSortable': false,
                'aTargets': [0]
            }],
        });

    });

</script>

<script type="text/javascript">

    $(document).ready(function () {

        oTableStaticFlow = $('#example1').DataTable({
            "aoColumnDefs": [{
                'bSortable': false,
                'aTargets': [0]
            }],
        });

    });

</script>

<script type="text/javascript">

    $(document).ready(function () {

        oTableStaticFlow = $('#example2').DataTable({
            "aoColumnDefs": [{
                'bSortable': false,
                'aTargets': [0]
            }],
        });

    });

</script>

<style>
    table.dataTable thead .sorting:after {
        opacity: 0 !important;
        content: none !important;
    }

    .dataTables_wrapper .dataTables_filter input {
        margin-left: 0em !important;
    }

    table.gridtable th {
        text-align: center;
        font-weight: bold;
        font-size: 14px;
        color: #3276b1;
    }

    table.gridtable td {
        text-align: center;
    }

    #chkSelectAll {
        margin-left: 4px !important;
    }

    .headerstyle {
        background-color: #cbd2d5 !important;
        color: #000 !important;
        font-weight: bold;
    }
</style>

<style type="text/css">
    .btnstyle {
        font-weight: bold;
        color: white;
        border: rgb(86, 138, 137);
        border-radius: 8px;
        padding: 8px;
        background-color: #496949;
    }

    table.datatable_tabletools {
        margin: 12px;
        width: 98%;
    }

        table.datatable_tabletools th {
            text-align: center;
            font-weight: bold;
            font-size: 14px;
            color: #3276b1;
        }

        table.datatable_tabletools td {
            text-align: center;
        }

    /*.Borderstyle
    {
        color:red;font-weight:bold;background-color:bisque;width:4%;
    }*/
    .headerstyle {
        text-align: center;
        font-weight: bold;
        background-color: #f7f7f9;
        color: #3276b1;
        width: 26.8%;
    }

    .headerstyle1 {
        text-align: center;
        font-weight: bold;
        background-color: #f7f7f9;
        color: #3276b1;
        width: 26.96%;
    }

    .headerstyle2 {
        text-align: center;
        font-weight: bold;
        background-color: #f7f7f9;
        color: #3276b1;
        width: 28%;
    }

    .columnstyle {
        text-align: center;
        font-weight: bold;
        background-color: #f7f7f9;
        color: #3276b1;
        width: 4.9%;
    }

    .columnstyle1 {
        text-align: center;
        font-weight: bold;
        background-color: #f7f7f9;
        color: #3276b1;
        width: 14.30%;
    }

    .red {
        font-weight: bold;
        font-size: 16px;
    }

    th, td {
        text-align: center;
    }



    .sno {
        text-align: center;
        font-weight: bold;
        background-color: #f7f7f9;
        color: #3276b1;
        width: 5.66%;
    }

    .gstin {
        text-align: center;
        font-weight: bold;
        background-color: #f7f7f9;
        color: #3276b1;
        width: 16.35%;
    }

    .upload {
        text-align: center;
        font-weight: bold;
        background-color: #f7f7f9;
        color: #3276b1;
        width: 31.48%;
    }

    .filing {
        text-align: center;
        font-weight: bold;
        background-color: #f7f7f9;
        color: #3276b1;
        width: 31.50%;
    }
</style>

<!-- MAIN CONTENT -->
<div id="content">

    <div class="row">

        <div class="col-xs-12 col-sm-7 col-md-7 col-lg-3">
            <h1 class="page-title txt-color-blueDark">

                <!-- PAGE HEADER -->
                <i class="fa-fw fa fa-home"></i>
                Summary Dashboard
                @*<span>
                        >&nbsp;
                        Dashboard
                    </span>*@
            </h1>
        </div>
        <div class="col-xs-12 col-sm-7 col-md-7 col-lg-9">

            <ul id="sparks" class="">
                <li class="sparks-info">
                    <h5>Total GSTIN<span class="txt-color-blue"><i class="fa fa-arrow-circle-up" data-rel="bootstrap-tooltip" title="Increased"></i>&nbsp;@ViewBag.TotalGSTIN</span></h5>
                    <div class="sparkline txt-color-blue hidden-mobile hidden-md hidden-sm">
                        110,150,300,130,400,240,220,310,220,300, 270, 210
                    </div>
                </li>
                <li class="sparks-info">
                    <h5> Output Tax Liability <span class="txt-color-purple">₹ @ViewBag.TotalTXI</span></h5>
                    <div class="sparkline txt-color-purple hidden-mobile hidden-md hidden-sm">
                        1300, 1877, 2500, 2577, 2000, 2100, 3000, 2700, 3631, 2471, 2700, 3631, 2471
                    </div>
                </li>
                <li class="sparks-info">
                    <h5>ITC<span class="txt-color-greenDark"><i class="" data-rel="bootstrap-tooltip" title="Increased"></i>&nbsp;₹ @ViewBag.TotalITC</span></h5>
                    <div class="sparkline txt-color-greenDark hidden-mobile hidden-md hidden-sm">
                        110,150,300,130,400,240,220,310,220,300, 270, 210
                    </div>
                </li>
                <li class="sparks-info">
                    <h5>Ledger Cash <span class="txt-color-orange"><i class=""></i>&nbsp;₹ @ViewBag.TotalLedger</span></h5>
                    <div class="sparkline txt-color-orange hidden-mobile hidden-md hidden-sm">
                        110,150,300,130,400,240,220,310,220,300, 270, 210
                    </div>
                </li>
            </ul>
        </div>
    </div>
    <div class="alert alert-block alert-success">
        <form action="@Url.Action("summary", "Dashboard")" method="POST" id="SummaryForm" class="smart-form" autocomplete="off">
            <h4 class="alert-heading"><i class="fa fa-check-square-o"></i> Summary Dashboard</h4>
            <br />
            <p>
                <div class="widget-body">
                    <div id="checkout-form" class="smart-form" novalidate="novalidate">
                        <fieldset>
                            <div class="row">
                                <section class="col col-lg-3">
                                    <label class="label"><b>Period</b> (MM/YYYY)</label>
                                    <label class="input">
                                        <i class="icon-append fa fa-calendar"></i>
                                        <input type="text" id="period" name="period" value="@ViewBag.Period" placeholder="Period" class="datepicker" data-dateformat='mmyy' onchange="submit();">
                                    </label>
                                </section>
                            </div>
                        </fieldset>
                    </div>
                </div>
            </p>
        </form>
    </div>

    <!-- row -->
    <div class="row">


        <div class="col-sm-12">

            <div class="well">
                <h1 style="font-family:Sans,Arial,Helvetica,Sans-Serif;"><span class="semi-bold">GSTR Filing Status</span> <small></small></h1>

                <ul class="list-inline">
                    <li style="margin-right:130px;">
                        &nbsp;&nbsp;&nbsp;
                        <div class="easy-pie-chart txt-color-blue easyPieChart" data-percent="@ViewBag.GSTR1Percent" data-size="180" data-pie-size="180">
                            <span class="percent percent-sign txt-color-blue font-xl semi-bold">@ViewBag.GSTR1Percent</span>

                        </div>
                        &nbsp;&nbsp;&nbsp;
                        <h3 style="text-align:center;font-family:Sans,Arial,Helvetica,Sans-Serif" class="txt-color-blue">GSTR1 Filing</h3>
                    </li>
                    <li style="margin-right:130px;">
                        &nbsp;&nbsp;&nbsp;
                        <div class="easy-pie-chart txt-color-purple easyPieChart" data-percent="@ViewBag.GSTR3BPercent" data-pie-size="180">
                            <span class="percent percent-sign txt-color-purple font-xl semi-bold">@ViewBag.GSTR3BPercent</span>
                        </div>
                        &nbsp;&nbsp;&nbsp;
                        <h3 style="text-align:center;font-family:Sans,Arial,Helvetica,Sans-Serif" class="txt-color-purple">GSTR3B Filing</h3>
                    </li>

                </ul>

            </div>

        </div>
    </div>

    <!-- end row -->
    <!-- row -->

    <div class="row">


    </div>

    <!-- end row -->



</div>
<!-- END MAIN CONTENT -->

<div id="content">

    <!-- widget grid -->
    <section id="widget-grid" class="">

        <!-- row -->
        <div class="row">

            <!-- NEW WIDGET START -->
            <article class="col-xs-12 col-sm-12 col-md-12 col-lg-12">

                <div class="jarviswidget jarviswidget-color-teal" id="wid-id-3" data-widget-editbutton="false">

                    <header>
                        <span class="widget-icon"> <i class="fa fa-table"></i> </span>
                        <h2>Summary Dashboard - (UPLOAD & FILING STATUS)</h2>

                    </header>

                    <div class="table table-responsive">

                        @if (ViewBag.Summary != null)
                        {
                            if (Enumerable.Count(ViewBag.Summary) > 0)
                            {
                                int i = 1;

                                <div class="container-fuild" style="background-color:white;">
                                    <table id="example" class="table table-striped table-responsive table-bordered table-hover gridtable">
                                        <thead>
                                            <tr>
                                                <td colspan="3" class="upload">#</td>
                                                <td colspan="2" class="upload">Upload Status</td>
                                                <td colspan="2" class="upload">Filing Status</td>
                                            </tr>
                                            <tr>
                                                <th>S.No</th>
                                                <th>Company Name</th>
                                                <th>GSTIN ↑↓</th>
                                                <th>GSTR1</th>
                                                <th>GSTR3B</th>
                                                <th>GSTR1</th>
                                                <th>GSTR3B</th>
                                            </tr>
                                        </thead>
                                        <tbody>
                                            @foreach (var item in result)
                                            {
                                                <tr>
                                                    <td>@Convert.ToInt32(i++)</td>
                                                    <td>@item.CompanyName</td>
                                                    <td><a style="text-decoration:underline" href="@Url.Action("Index","Dashboard",  new { @gstin = @item.GSTINNo, @period = ViewBag.Period})">@item.GSTINNo</a></td>
                                                    <td>
                                                        @if (item.GSTR1_U == 0)
                                                        {
                                                            <div class="text-danger red">Pending</div>
                                                        }
                                                        else if (item.GSTR1_U == 1)
                                                        {
                                                            <div class="text-warning red">In Progress</div>
                                                        }
                                                        else if (item.GSTR1_U == 2)
                                                        {
                                                            <div class="text-success red">Completed</div>
                                                        }
                                                    </td>

                                                    <td>
                                                        @if (item.GSTR3B_U == 0)
                                                        {
                                                            <div class="text-danger red">Pending</div>
                                                        }
                                                        else if (item.GSTR3B_U == 1)
                                                        {
                                                            <div class="text-warning red">In Progress</div>
                                                        }
                                                        else if (item.GSTR3B_U == 2)
                                                        {
                                                            <div class="text-success red">Completed</div>
                                                        }
                                                    </td>
                                                    <td>
                                                        @if (item.GSTR1_F == 0)
                                                        {
                                                            <div class="text-danger red">Pending</div>
                                                        }
                                                        else if (item.GSTR1_F == 1)
                                                        {
                                                            <div class="text-success red">Completed</div>
                                                        }
                                                    </td>
                                                    <td>
                                                        @if (item.GSTR3B_F == 0)
                                                        {
                                                            <div class="text-danger red">Pending</div>
                                                        }
                                                        else if (item.GSTR3B_F == 1)
                                                        {
                                                            <div class="text-success red">Completed</div>
                                                        }
                                                    </td>
                                                </tr>
                                            }
                                        </tbody>
                                    </table>

                                </div>

                            }

                            else
                            {
                                <div style="text-align:left">
                                    <br /><br />
                                    <h3 style="text-align:left !important">No Data Found</h3>
                                </div>

                            }
                        }

                    </div>

                </div>
                <!-- end widget -->

            </article>
            <!-- WIDGET END -->

        </div>

        <!-- end row -->
        <!-- end row -->

    </section>
    <!-- end widget grid -->

</div>

<div id="content">



    <!-- widget grid -->
    <section id="widget-grid" class="">

        <!-- row -->
        <div class="row">

            <!-- NEW WIDGET START -->
            <article class="col-xs-12 col-sm-12 col-md-12 col-lg-12">

                <div class="jarviswidget jarviswidget-color-teal" id="wid-id-3" data-widget-editbutton="false">

                    <header>
                        <span class="widget-icon"> <i class="fa fa-table"></i> </span>
                        <h2>Summary Dashboard - (OUTPUT TAX LIABILITY)</h2>

                    </header>

                    <div class="table table-responsive">

                        @if (ViewBag.Summary != null)
                        {
                            if (Enumerable.Count(ViewBag.Summary) > 0)
                            {
                                int j = 1;

                                <div class="container-fuild" style="background-color:white;">
                                    <table id="example1" class="table table-striped table-responsive table-bordered table-hover gridtable">
                                        <thead>
                                            <tr>
                                                <td colspan="3" class="upload">#</td>
                                                <td colspan="4" class="upload">OUTPUT Tax Liability</td>
                                            </tr>
                                            <tr>
                                                <th>S.No</th>
                                                <th>Company Name</th>
                                                <th>GSTIN ↑↓</th>
                                                <th>IGST</th>
                                                <th>CGST</th>
                                                <th>SGST</th>
                                                <th>CESS</th>
                                            </tr>
                                        </thead>
                                        <tbody>
                                            @foreach (var item in result)
                                            {
                                                <tr>
                                                    <td>@Convert.ToInt32(j++)</td>
                                                    <td>@item.CompanyName</td>
                                                    <td><a style="text-decoration:underline" href="@Url.Action("Index","Dashboard",  new { @gstin = @item.GSTINNo, @period = ViewBag.Period})">@item.GSTINNo</a></td>
                                                    <td>@item.OIGST</td>
                                                    <td>@item.OCGST</td>
                                                    <td>@item.OSGST</td>
                                                    <td>@item.OCESS</td>
                                                </tr>
                                            }
                                        </tbody>
                                    </table>

                                </div>

                            }

                            else
                            {
                                <div style="text-align:left">
                                    <br /><br />
                                    <h3 style="text-align:left !important">No Data Found</h3>
                                </div>

                            }
                        }

                    </div>

                </div>
                <!-- end widget -->

            </article>
            <!-- WIDGET END -->

        </div>

        <!-- end row -->
        <!-- end row -->

    </section>
    <!-- end widget grid -->

</div>

<div id="content">



    <!-- widget grid -->
    <section id="widget-grid" class="">

        <!-- row -->
        <div class="row">

            <!-- NEW WIDGET START -->
            <article class="col-xs-12 col-sm-12 col-md-12 col-lg-12">

                <div class="jarviswidget jarviswidget-color-teal" id="wid-id-3" data-widget-editbutton="false">

                    <header>
                        <span class="widget-icon"> <i class="fa fa-table"></i> </span>
                        <h2>Summary Dashboard - (ITC, LEDGER CASH)</h2>

                    </header>

                    <div class="table table-responsive">

                        @if (ViewBag.ITCLedger != null)
                        {
                            if (Enumerable.Count(ViewBag.ITCLedger) > 0)
                            {
                                int k = 1;

                                <div class="container-fuild" style="background-color:white;">
                                    <table id="example2" class="table table-striped table-responsive table-bordered table-hover gridtable">
                                        <thead>
                                            <tr>
                                                <td colspan="3" class="upload">#</td>
                                                <td colspan="4" class="upload">ITC</td>
                                                <td colspan="4" class="upload">Ledger Cash</td>
                                            </tr>
                                            <tr>
                                                <th>S.No</th>
                                                <th>Company Name</th>
                                                <th>GSTIN ↑↓</th>
                                                <th>IGST</th>
                                                <th>CGST</th>
                                                <th>SGST</th>
                                                <th>CESS</th>
                                                <th>IGST</th>
                                                <th>CGST</th>
                                                <th>SGST</th>
                                                <th>CESS</th>
                                            </tr>
                                        </thead>
                                        <tbody>
                                            @foreach (var item in result1)
                                            {
                                                <tr>
                                                    <td>@Convert.ToInt32(k++)</td>
                                                    <td>@item.CompanyName</td>
                                                    <td><a style="text-decoration:underline" href="@Url.Action("Index","Dashboard",  new { @gstin = @item.GSTINNo, @period = ViewBag.Period})">@item.GSTINNo</a></td>
                                                    <td>@item.ITC_Igst</td>
                                                    <td>@item.ITC_Cgst</td>
                                                    <td>@item.ITC_Sgst</td>
                                                    <td>@item.ITC_Cess</td>
                                                    <td>@item.Ledger_Igst</td>
                                                    <td>@item.Ledger_Cgst</td>
                                                    <td>@item.Ledger_Sgst</td>
                                                    <td>@item.Ledger_Cess</td>
                                                </tr>
                                            }
                                        </tbody>
                                    </table>

                                </div>

                            }

                            else
                            {
                                <div style="text-align:left">
                                    <br /><br />
                                    <h3 style="text-align:left !important">No Data Found</h3>
                                </div>

                            }
                        }

                    </div>

                </div>
                <!-- end widget -->

            </article>
            <!-- WIDGET END -->

        </div>

        <!-- end row -->
        <!-- end row -->

    </section>
    <!-- end widget grid -->

</div>



@if (TempData["msg"] != null)
{
    <script type="text/javascript">
        alert(@Html.Raw(Json.Encode(TempData["msg"])));
    </script>
}

@if (TempData["MakerCheckerMessage"] != null)
{
    <script type="text/javascript">
        window.onload = function () {
            swal({
                title: "",
                text: "@TempData["MakerCheckerMessage"]",
                type: "error",
                confirm: {
                    text: "OK",
                    value: true,
                    visible: true,
                    className: "",
                    closeModal: true,
                },
                confirmButtonColor: "#DD6B55",
                confirmButtonText: "OK",
                closeOnConfirm: true,

            }
     );
        };
    </script>
    TempData["MakerCheckerMessage"] = null;
}


@section pagespecific {
    <script type="text/javascript">

        // DO NOT REMOVE : GLOBAL FUNCTIONS!

        $(document).ready(function () {

            /* // DOM Position key index //

            l - Length changing (dropdown)
            f - Filtering input (search)
            t - The Table! (datatable)
            i - Information (records)
            p - Pagination (paging)
            r - pRocessing
            < and > - div elements
            <"#id" and > - div with an id
            <"class" and > - div with a class
            <"#id.class" and > - div with an id and class

            Also see: http://legacy.datatables.net/usage/features
            */

            /* BASIC ;*/
            var responsiveHelper_dt_basic = undefined;
            var responsiveHelper_datatable_fixed_column = undefined;
            var responsiveHelper_datatable_col_reorder = undefined;
            var responsiveHelper_datatable_tabletools = undefined;

            var breakpointDefinition = {
                tablet: 1024,
                phone: 480
            };

            /* TABLETOOLS */
            $('#datatable_tabletools').dataTable({

                // Tabletools options:
                //   https://datatables.net/extensions/tabletools/button_options
                "sDom": "<'dt-toolbar'<'col-xs-12 col-sm-6'f><'col-sm-6 col-xs-6 hidden-xs'T>r>" +
                    "t" +
                    "<'dt-toolbar-footer'<'col-sm-6 col-xs-12 hidden-xs'i><'col-sm-6 col-xs-12'p>>",
                "oTableTools": {
                    "aButtons": [
                        "copy",
                        "csv",
                        "xls",
                        {
                            "sExtends": "pdf",
                            "sTitle": "SmartAdmin_PDF",
                            "sPdfMessage": "SmartAdmin PDF Export",
                            "sPdfSize": "letter"
                        },
                        {
                            "sExtends": "print",
                            "sMessage": "Generated by SmartAdmin <i>(press Esc to close)</i>"
                        }
                    ],
                    "sSwfPath": "/Scripts/plugin/datatables/swf/copy_csv_xls_pdf.swf"
                },
                "autoWidth": true,
                "preDrawCallback": function () {
                    // Initialize the responsive datatables helper once.
                    if (!responsiveHelper_datatable_tabletools) {
                        responsiveHelper_datatable_tabletools = new ResponsiveDatatablesHelper($('#datatable_tabletools'), breakpointDefinition);
                    }
                },
                "rowCallback": function (nRow) {
                    responsiveHelper_datatable_tabletools.createExpandIcon(nRow);
                },
                "drawCallback": function (oSettings) {
                    responsiveHelper_datatable_tabletools.respond();
                }
            });

            /* END TABLETOOLS */

        })

    </script>
}