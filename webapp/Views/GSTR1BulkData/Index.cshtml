@using System.Dynamic
@model List<System.Collections.IDictionary>
@{
    WebGrid grid = null;
    var result = new List<dynamic>();
    if (ViewBag.BulkDataProcessed != null)
    {
        //TempData["Data"] = Model;
        foreach (var emprow in ViewBag.BulkDataProcessed)
        {
            var row = (IDictionary<string, object>)new ExpandoObject();
            Dictionary<string, object> eachEmpRow = (Dictionary<string, object>)emprow;

            foreach (KeyValuePair<string, object> keyValuePair in eachEmpRow)
            {
                row.Add(keyValuePair);
            }
            result.Add(row);
        }
        grid = new WebGrid(source: result, canPage: true, canSort: true);
    }
}

@{
    WebGrid grid1 = null;
    var result1 = new List<dynamic>();
    if (ViewBag.BulkDataErrorRecords != null)
    {
        //TempData["Data"] = Model;
        foreach (var emprow in ViewBag.BulkDataErrorRecords)
        {
            var row = (IDictionary<string, object>)new ExpandoObject();
            Dictionary<string, object> eachEmpRow = (Dictionary<string, object>)emprow;

            foreach (KeyValuePair<string, object> keyValuePair in eachEmpRow)
            {
                row.Add(keyValuePair);
            }
            result1.Add(row);
        }
        grid1 = new WebGrid(source: result1, canPage: true, canSort: true);
    }
}

<!-- MAIN CONTENT -->
@using (Html.BeginForm("Index", "GSTR1BulkData", FormMethod.Post, new { @id = "GSTR1BulkDataForm", @name = "GSTR1BulkDataForm" }))
{
    <div id="content">

        <!-- row -->
        <div class="row">

            <!-- col -->
            <div class="col-xs-12 col-sm-7 col-md-7 col-lg-4">
                <h1 class="page-title txt-color-blueDark">

                    <!-- PAGE HEADER -->
                    <i class="fa-fw fa fa-home"></i>
                    GSTR-1
                    <span>
                        >&nbsp;
                        Summary
                    </span>
                </h1>
            </div>
            <!-- end col -->
            <!-- right side of the page with the sparkline graphs -->
            <!-- col -->
            <!-- end col -->

        </div>
        <div class="alert alert-block alert-success">

            @*<form action="@Url.Action("Index", "GSTR1BulkData")" method="POST" id="SummaryForm" class="smart-form" autocomplete="off">*@
            <h4 class="alert-heading"><i class="fa fa-check-square-o"></i> GSTR-1 Summary</h4>
            <br />
            <p>
                <div class="widget-body">

                    <div id="checkout-form" class="smart-form" novalidate="novalidate">

                        <fieldset>
                            <div class="row">
                                <section class="col col-3">
                                    <label class="input">GSTIN</label>
                                    <div class="col-xs-12 col-md-12 selectContainer">
                                        @Html.DropDownList("ddlGSTINNo", ViewBag.GSTINNoList as SelectList, "ALL", new { @class = "form-control", onchange = "submit();" })
                                    </div>
                                </section>
                                <section class="col col-3">
                                    <label class="input">Period</label>
                                    <label class="input">
                                        <input type="text" name="period" value="@ViewBag.Period" placeholder="Period" class="datepicker" data-dateformat='mmyy' onchange="submit();">
                                    </label>
                                </section>
                                @*<section class="col col-3">
                                        <label class="input">Customer Name</label>
                                        <div class="col-xs-12 col-md-12 selectContainer">
                                            @Html.DropDownList("ddlCustomerName", ViewBag.CTINNoList as SelectList, "ALL", new { @class = "form-control", onchange = "submit();" })
                                        </div>
                                    </section>*@
                            </div>
                        </fieldset>
                        @*<footer>
                            <button type="submit" name="GSTR1Save" value="GSTR 1 Save" class="btn btn-primary pull-left" style="border-radius:13px;font-weight:600">
                                GSTR 1 Save
                            </button>
                        </footer>*@
                    </div>
                </div>
            </p>
            @*</form>*@
        </div>
        <!-- end row -->
        <!-- widget grid -->
        <section id="widget-grid" class="">

            <!-- row -->
            <div class="row">

                <!-- NEW WIDGET START -->
                <article class="col-xs-12 col-sm-12 col-md-12 col-lg-12">
                    <!-- Widget ID (each widget will need unique ID)-->
                    <div class="jarviswidget jarviswidget-color-greenLight" id="wid-id-1" data-widget-editbutton="false" data-widget-custombutton="false" data-widget-deletebutton="false">

                        <header>
                            <span class="widget-icon"> <i class="fa fa-edit"></i> </span>
                            <h2>@ViewBag.TitleHeaders</h2>
                        </header>

                        <div class="table table-responsive">

                            @if (ViewBag.BulkDataProcessed != null)
                            {
                                if (Enumerable.Count(ViewBag.BulkDataProcessed) > 0)
                                {
                                    int i = 1;
                                    <div class="container-fuild" style="background-color:white;">
                                        <table id="G1_B2B" class="table table-striped table-responsive table-bordered table-hover gridtable">                                            
                                            <thead>
                                                <tr>
                                                    <td colspan="8" style="background-color:cornflowerblue;">
                                                        <h3><b>Processed Data Summary</b></h3>
                                                    </td>
                                                </tr>
                                                <tr>
                                                    @*<td align="center"><input type="checkbox" id="chkSelectAll_B2B" name="ids" /></td>*@
                                                    <th>S.No</th>
                                                    <th>Action</th>
                                                    @*<th>Invoice No</th>
                                                        <th>Invoice Date</th>
                                                        <th>Invoice Value</th>
                                                        <th>POS</th>
                                                        <th>ETIN</th>
                                                        <th>Rate</th>*@
                                                    <th>Taxable Value</th>
                                                    <th>IGST Amount</th>
                                                    <th>CGST Amount</th>
                                                    <th>SGST Amount</th>
                                                    <th>CESS Amount</th>
                                                    <th>Action</th>
                                                </tr>
                                            </thead>
                                            <tbody>
                                                @foreach (var item in result)
                        {
                                                    <tr>
                                                        @*<td align="center">
                                                                <input class="check-box chkSelectAll_B2B" id="ids" name="ids" type="checkbox" value="@item.invid" />
                                                            </td>*@
                                                        <td>@Convert.ToInt32(i++)</td>
                                                        <td>@item.actiontype</td>
                                                        @*<td>@item.inum</td>
                                                            <td>@item.idt</td>
                                                            <td>@item.val</td>
                                                            <td>@item.pos</td>
                                                            <td>@item.etin</td>
                                                            <td>@item.rt</td>*@
                                                        <td>@item.txval</td>
                                                        <td>@item.iamt</td>
                                                        <td>@item.camt</td>
                                                        <td>@item.samt</td>
                                                        <td>@item.csamt</td>
                                                        <td>
                                                            <button name="Download" value="@item.actiontype" class="btn btn-link" style="text-decoration:underline;">
                                                                Download
                                                            </button> 
                                                        </td>
                                                    </tr>
                                                }
                                            </tbody>
                                        </table>
                                    </div>
                                    <br />

                                    <div class="container-fuild" style="background-color:white;">
                                        <table id="G1_B2B" class="table table-striped table-responsive table-bordered table-hover gridtable">
                                            <thead>
                                                <tr>
                                                    <td colspan="3" style="background-color:cornflowerblue;">
                                                        <h3><b>Error Data Summary</b></h3>
                                                    </td>
                                                </tr>
                                                <tr>
                                                    <th>Total Records Count : @ViewBag.TotalCount</th>
                                                    <th>Total Processed Records Count : @ViewBag.TotalProcessed</th>
                                                    <th>
                                                        <button name="ErrorDownload" value="Error Download" class="btn btn-link" style="text-decoration:underline;">
                                                            Total Error Records Count : @ViewBag.TotalError
                                                        </button>                                                        
                                                    </th>
                                                </tr>
                                            </thead>
                                        </table>
                                    </div>

                                }
                                else
                                {
                                    <h3>No Data Found</h3>
                                }
                            }
                        </div>



                        <!-- widget div-->
                        <div>

                            <!-- widget edit box -->
                            <div class="jarviswidget-editbox">
                                <!-- This area used as dropdown edit box -->

                            </div>
                            <!-- end widget edit box -->
                            <!-- widget content -->
                            <div class="widget-body no-padding">

                                <div id="comment-form1" class="smart-form">

                                    <div class="message">
                                        <i class="fa fa-check fa-lg"></i>
                                        <p>
                                            Your comment was successfully added!
                                        </p>
                                    </div>
                                </div>

                            </div>
                            <!-- end widget content -->

                        </div>
                        <!-- end widget div -->

                    </div>
                    <!-- end widget -->
                </article>
            </div>
        </section>

    </div>
}
<!-- END MAIN CONTENT -->

@if (TempData["Response"] != null)
            {
    <script type="text/javascript">
        alert(@Html.Raw(Json.Encode(TempData["Response"])));
        TempData["Response"] = null;
    </script>
}
